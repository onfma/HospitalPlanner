<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
  <title>HospitalPlanner</title>
  <link rel="shortcut icon" href="../static/img/page_icon.png" type="image/x-icon">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <link rel="stylesheet" href="../static/styles/general_style.css">
  <link rel="stylesheet" href="../static/styles/header_style.css">
  <link rel="stylesheet" href="../static/styles/homepage_style.css">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>

<!-- HEADER -->
<div class="container-fluid pt-5 pb-5 px-5" style="background-color: #1F2B6C;">
  <div class="d-flex justify-content-between mb-1 ml-5 px-5" style="background-color: transparent !important;">
    <div class="bg-info text-center" style="background-color: transparent !important;">
      <a href="/adminDashboard" class="header_title">HOSPITAL<a href="/adminDashboard" class="header_title" style="color: #159EEC;">PLANNER</a></a>
    </div>

    <div class="d-flex flex-row-reverse">
      <div class="p-2">
        <a href="/logout">
          <button type="button" class="btn"
                  style="background-color: #159EEC; color: #BFD2F8; border-radius: 50px; font-weight: 500; font-family: Work_Sans; margin-left:40px;">Logout</button>
        </a>
      </div>
      <div class="p-2">
        <a href="/adminViewPatients" ><button type="button" class="btn"
                                              style="background-color: #BFD2F8; color: #1F2B6C; border-radius: 50px; font-weight: 500; font-family: Work_Sans;">View Patients</button></a>
      </div>
      <div class="p-2 px-5">
        <a href="/adminViewDoctors" ><button type="button" class="btn"
                                             style="background-color: #BFD2F8; color: #1F2B6C; border-radius: 50px; font-weight: 500; font-family: Work_Sans;">View Doctors</button></a>
      </div>
      <div class="p-2">
        <a href="/adminViewCabinets" ><button type="button" class="btn"
                                              style="background-color: #BFD2F8; color: #1F2B6C; border-radius: 50px; font-weight: 500; font-family: Work_Sans;">View Cabinets</button></a>
      </div>

    </div>
  </div>
</div>

<!-- BODY -->
<div class="container-fluid pb-5 px-5" style="background-color: transparent !important; margin-top: 50px; margin-bottom: 50px;">

  <!-- title -->
  <div class="container-fluid pt-2 pb-5 px-5 text-center homepage_title">Modify Patient <a style="color: #159EEC;">account</a></div>


  <!--    error message-->
  <div th:if="${error}" class="alert alert-danger" role="alert">
    <span th:text="${error}"></span>
  </div>

  <!--    successfully message-->
  <div th:if="${successMessage}" class="alert alert-success" role="alert">
    <span th:text="${successMessage}"></span>
  </div>

  <!-- account form -->
  <form action="/adminModifyPatient/modifyAccount" method="POST" class="container-fluid mt-3">
    <div class="row">
      <!-- info boxes -->
      <div class="col-sm-12 p-3">
        <div class="row mb-3">
          <!-- cnp -->
          <div class="col pt-3 pb-2" style="background-color: #1F2B6C; border-radius: 10px; margin-right: 15px;" id="cnp">
            <div>
              <a class="container-fluid" style="height: 20px; color: #159EEC; text-decoration: none">CNP:</a>
              <a class="container-fluid" style="height: 20px; color: #FCFEFE; text-decoration: none" th:text="${patient.cnp}"></a>
            </div>
          </div>
          <!-- gender -->
          <div class="col pt-3 pb-2" style="background-color: #1F2B6C; border-radius: 10px; margin-left: 15px;" id="gender">
            <div>
              <a class="container-fluid" style="height: 20px; color: #159EEC; text-decoration: none">Gender:</a>
              <a class="container-fluid" style="height: 20px; color: #FCFEFE; text-decoration: none" th:text="${patient.gender}"></a>
            </div>
          </div>
        </div>

        <div class="row mb-3">
          <!-- first name -->
          <div class="col pt-3 pb-2" style="background-color: #1F2B6C; border-radius: 10px; margin-right: 15px;" id="firstName">
            <div>
              <a class="container-fluid" style="height: 20px; color: #159EEC; text-decoration: none">First name:</a>
              <a class="container-fluid" style="height: 20px; color: #FCFEFE; text-decoration: none" th:text="${patient.firstName}"></a>
            </div>
            <div class="form-floating mt-2 mb-3" style="position: relative;">
              <img src="../static/img/user_emote.png" alt="user_emote" style="position: absolute; right: 0; padding-right: 30px; top: 25%;">
              <input type="text" class="form-control" id="first_name" placeholder="Change your first name" name="first_name" style="background-color: #BFD2F8; color: #1F2B6C; border-radius: 5px; font-family: Work_Sans; font-weight: 500; font-size: 24px; line-height: 28px;">
              <label for="first_name" style="display: flex; align-items: center;">
                Change your first name
              </label>
            </div>
          </div>
          <!-- last name -->
          <div class="col pt-3 pb-2" style="background-color: #1F2B6C; border-radius: 10px; margin-left: 15px;" id="lastName">
            <div>
              <a class="container-fluid" style="height: 20px; color: #159EEC; text-decoration: none">Last name:</a>
              <a class="container-fluid" style="height: 20px; color: #FCFEFE; text-decoration: none" th:text="${patient.lastName}"></a>
            </div>
            <div class="form-floating mb-3 mt-2" style="position: relative;">
              <img src="../static/img/user_emote.png" alt="user_emote" style="position: absolute; right: 0; padding-right: 30px; top: 25%;">
              <input type="text" class="form-control" id="last_name" placeholder="Change your last name" name="last_name" style="background-color: #BFD2F8; color: #1F2B6C; border-radius: 5px; font-family: Work_Sans; font-weight: 500; font-size: 24px; line-height: 28px;">
              <label for="last_name" style="display: flex; align-items: center;">
                Change your last name
              </label>
            </div>
          </div>
        </div>

        <div class="row mb-3">
          <!-- tel -->
          <div class="col pt-3 pb-2" style="background-color: #1F2B6C; border-radius: 10px; margin-right: 15px;">
            <div>
              <a class="container-fluid" style="height: 20px; color: #159EEC; text-decoration: none">Phone number:</a>
              <a class="container-fluid" style="height: 20px; color: #FCFEFE; text-decoration: none" th:text="${patient.phoneNumber}"></a>
            </div>
            <div class="form-floating mb-3 mt-2" style="position: relative;">
              <img src="../static/img/phone_emote_form.png" alt="user_emote" style="position: absolute; right: 0; padding-right: 30px; top: 25%;">
              <input type="tel" class="form-control" id="tel" placeholder="Change your phone number" name="tel" pattern="[0-9]{10}" title="Phone number should be a 10-digit number. EX: '0712345678'" style="background-color: #BFD2F8; color: #1F2B6C; border-radius: 5px; font-family: Work_Sans; font-weight: 500; font-size: 24px; line-height: 28px;">
              <label for="tel" style="display: flex; align-items: center;">
                Change your phone number
              </label>
            </div>
          </div>
          <!-- home address -->
          <div class="col pt-3 pb-2" style="background-color: #1F2B6C; border-radius: 10px; margin-left: 15px;">
            <div>
              <a class="container-fluid" style="height: 20px; color: #159EEC; text-decoration: none">Address:</a>
              <a class="container-fluid" style="height: 20px; color: #FCFEFE; text-decoration: none" th:text="${patient.address}"></a>
            </div>
            <div class="form-floating mb-3 mt-2" style="position: relative;">
              <img src="../static/img/home_emote_form.png" alt="user_emote" style="position: absolute; right: 0; padding-right: 30px; top: 25%;">
              <input type="text" class="form-control" id="home_address" placeholder="Change your home address" name="home_address" pattern="[a-zA-Z0-9,. ;]+" title="Address should contain only letters, digits, or the following characters: [,.;]" style="background-color: #BFD2F8; color: #1F2B6C; border-radius: 5px; font-family: Work_Sans; font-weight: 500; font-size: 24px; line-height: 28px;">
              <label for="home_address" style="display: flex; align-items: center;">
                Change your home address
              </label>
            </div>
          </div>
        </div>

        <div class="row mb-3">
          <!-- email -->
          <div class="col pt-3 pb-2" style="background-color: #1F2B6C; border-radius: 10px;">
            <div>
              <a class="container-fluid" style="height: 20px; color: #159EEC; text-decoration: none">Email address:</a>
              <a class="container-fluid" style="height: 20px; color: #FCFEFE; text-decoration: none" th:text="${patient.email}"></a>
            </div>
            <div class="form-floating mb-3 mt-2" style="position: relative;">
              <img src="../static/img/email_emote_form.png" alt="user_emote" style="position: absolute; right: 0; padding-right: 30px; top: 25%;">
              <input type="email" class="form-control" id="email" placeholder="Change your email address" name="email"
                     pattern="^[a-zA-Z0-9\\Q#$%^&*,.?~@[]{}+-_/=\\E]+@[a-zA-Z0-9]+\\.[a-zA-Z0-9]+$" oninvalid="setCustomValidity('Email format should be in that format: user@example.com')"
                     oninput="setCustomValidity('')"
                     style="background-color: #BFD2F8; color: #1F2B6C; border-radius: 5px; font-family: Work_Sans; font-weight: 500; font-size: 24px; line-height: 28px;">
              <label for="email" style="display: flex; align-items: center;">
                Change your email address
              </label>
            </div>
          </div>
        </div>

      </div>

      <button id="submitButtonAccount" type="submit" class="btn btn-primary pt-2 pb-2 px-5" style="background-color: #159EEC; color: #FCFEFE; border-radius: 50px; font-weight: 500; font-size: 26px; line-height: 42px; font-family: Work_Sans;" disabled>Save Changes</button>


    </div>
  </form>

  <!-- title -->
  <div class="container-fluid pt-2 pb-5 px-5 mt-5 text-center homepage_title">Patient <a style="color: #159EEC;">appointments</a></div>

  <div th:each="appointment : ${appointments}" class="d-flex justify-content-around mb-3">
    <!-- appointment 1 -->
    <div class="p-4 d-inline-flex mb-3" style="background-color: #1F2B6C; border-radius: 10px; color: #FCFEFE; width: 40%">
      <div class="p-3" style="width: 80%">
        <div class="pb-1 d-inline-flex " style="width:100%">
          <img src="../static/img/calendar_emote.svg" alt="calendar" style="width: 10%">
          <div class="px-3" style="font-family: Work_Sans; font-weight: 400; font-size: 18px; line-height: 140%;">
            <a style="font-family: Work_Sans; font-weight: 700; font-size: 18px; line-height: 140%;" th:text="${appointment.appointmentTime.toLocalDate()}"></a>
            <br>
            <a style="font-family: Work_Sans; font-weight: 400; font-size: 16px; line-height: 140%;" th:text="${appointment.appointmentTime.toLocalTime()}"></a>
          </div>
        </div>
        <div style="font-family: Work_Sans; font-weight: 700; font-size: 18px; line-height: 140%; width:100%;" th:text="'Dr. ' + ${appointment.doctorFirstName} + ' ' + ${appointment.doctorLastName} + ' - ' + ${appointment.specialityName}">
        </div>
      </div>
      <div class="" style="display: flex; align-items: center; justify-content: center; ">
        <button type="button" class="btn px-5" style="background-color: #BFD2F8; color: #1F2B6C; border-radius: 50px; font-weight: 500; font-family: Work_Sans;"
                th:attr="data-appointment-id=${appointment.id}" onclick="cancelAppointment(this)">Cancel</button>
      </div>
    </div>
  </div>

</div>

<!-- FOOTER -->
<div class="container-fluid pt-5 pb-3 px-5" style="background-color: #1F2B6C;">
  <div class="container-fluid pt-2 pb-2 px-5 text-center header_title" style="color: #BFD2F8;">HOSPITALPLANNER</div>
  <div class="container-fluid pt-2 pb-5 px-5 text-center" style="font-weight: 400; font-size: 18px; line-height: 140%; color: #FCFEFE; font-family: Work_Sans;">
    Proiecteare Avansata - Facultatea de Informatica Iasi - 2023<br>© Chichirau Claudiu-Constantin & Onofrei Maria
  </div>
</div>

</body>

<script>
  $(document).ready(function() {
    $('.dropdown-menu a').click(function(event) {
      event.preventDefault(); // Prevent the default behavior of following the href link
      var selectedOption = $(this).text();
      $(this).closest('.dropdown').find('.form-control').val(selectedOption);
    });
  });

  $(document).ready(function() {
    $('input').on('input', function() {
      var formValid = false;

      $('input').each(function() {
        if ($(this).val().trim() !== '') {
          formValid = true;
          return false;
        }
      });

      if (formValid) {
        $('#submitButtonAccount').removeAttr('disabled');
      } else {
        $('#submitButtonAccount').attr('disabled', 'disabled');
      }
    });
  });


  function cancelAppointment(button) {
    var appointmentId = button.getAttribute("data-appointment-id");

    window.location.href = "/adminModifyPatient/cancelAppointment/" + appointmentId;
}
</script>
</html>