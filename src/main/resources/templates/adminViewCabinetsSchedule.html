<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
  <title>HospitalPlanner</title>
  <link rel="shortcut icon" href="../static/img/page_icon.png" type="image/x-icon">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <link rel="stylesheet" href="../static/styles/general_style.css">
  <link rel="stylesheet" href="../static/styles/header_style.css">
  <link rel="stylesheet" href="../static/styles/homepage_style.css">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<!--TODO: butonul ala de submit sa fie disponibil doar cand e modificata o ora gen-->
<!--TODO: idk cum o sa fie cu generarea de cod aici ca e cam futere cu id urile si scriptul pt modalele de timp ca.s multe-->
<body>

<!-- HEADER -->
<div class="container-fluid pt-5 pb-5 px-5" style="background-color: #1F2B6C;">
  <div class="d-flex justify-content-between mb-1 ml-5 px-5" style="background-color: transparent !important;">
    <div class="bg-info text-center" style="background-color: transparent !important;">
      <div class="header_title">HOSPITAL<a style="color: #159EEC;">PLANNER</a></div>
    </div>

    <div class="d-flex flex-row-reverse" style="background-color: black">
      <div class="p-2">
        <a href="/logout">
          <button type="button" class="btn"
                  style="background-color: #159EEC; color: #BFD2F8; border-radius: 50px; font-weight: 500; font-family: Work_Sans; margin-left:40px;">Logout</button>
        </a>
      </div>
      <div class="p-2">
        <a href="/adminViewPatients" ><button type="button" class="btn"
                                              style="background-color: #BFD2F8; color: #1F2B6C; border-radius: 50px; font-weight: 500; font-family: Work_Sans;">View People</button></a>
      </div>
      <div class="p-2 px-5">
        <a href="/adminViewDoctors" ><button type="button" class="btn"
                                             style="background-color: #BFD2F8; color: #1F2B6C; border-radius: 50px; font-weight: 500; font-family: Work_Sans;">View Doctors</button></a>
      </div>
      <div class="p-2">
        <a href="/adminViewCabinets" ><button type="button" class="btn"
                                              style="background-color: #BFD2F8; color: #1F2B6C; border-radius: 50px; font-weight: 500; font-family: Work_Sans;">View Cabinets</button></a>
      </div>

    </div>
  </div>
</div>

  <!-- BODY -->
  <div class="container-fluid pb-5 px-5" style="background-color: transparent !important; margin-top: 50px; margin-bottom: 50px;">

    <!-- title -->
    <div class="container-fluid pt-2 pb-5 px-5 text-center homepage_title">Cabinets of Hospital<a style="color: #159EEC;">Planner</a></div>

    <!-- program cabinete -->
    <div class="container-fluid d-flex justify-content-around" style="height: 500px;">
      <!-- cabinet 1 -->
      <form class="col-sm-5 p-3" style="background-color: #1F2B6C; width: 40%; border-radius: 10px;">
        <!-- titlu -->
        <div class="container-fluid text-center"
             style="height: 15%;
                           font-family: Yeseva_One;
                           font-weight: 400;
                           font-size: 26px;
                           line-height: 55px;
                           color: #BFD2F8;" th:text="${name}">Cabinet 1
        </div>

        <!-- zile -->
        <div th:each="schedule, status : ${cabinetScheduleList}" class="container-fluid px-3 pb-4 d-flex flex-column justify-content-between text-center" style="height: 11%; color: #FCFEFE;">
          <!-- Monday -->
          <div class="d-flex justify-content-start" style="">
            <div class="p-2 text_schedule" id="days_input" style="width: 45%; text-align: start;" th:text="${schedule.dayOfWeek}"></div>
            <div class="p-2 text_schedule" style="font-size: 26px; color: #159EEC;">-</div>
            <div class="text_schedule d-flex justify-content-start" style="text-align: end; width:100%">
              <div class="p-2"><input type="time" th:id="'startTime_' + ${status.index}" class="time_box" th:data-start-time="${schedule.startTime}"></div>
              <div class="p-2"><input type="time" th:id="'endTime_' + ${status.index}" class="time_box" th:data-end-time="${schedule.endTime}"></div>
            </div>
          </div>
        </div>
          <!-- Saturday -->
          <div class="d-flex justify-content-start" style="">
            <div class="p-2 text_schedule" style="width: 45%; text-align: start;">Saturday</div>
            <div class="p-2 text_schedule" style="font-size: 26px; color: #159EEC;">-</div>
            <div class="p-2 text_schedule" style="text-align: center; width: 96%">Closed</div>
          </div>
          <!-- Sunday -->
          <div class="d-flex justify-content-start" style="">
            <div class="p-2 text_schedule" style="width: 45%; text-align: start;">Sunday</div>
            <div class="p-2 text_schedule" style="font-size: 26px; color: #159EEC;">-</div>
            <div class="p-2 text_schedule" style=" text-align: center; width: 96%">Closed</div>
          </div>

        <!-- footer 2.0 micut -->
        <div class="container-fluid text-center pt-2 border-top border-5"
             style="height: 15%;
                           font-family: Yeseva_One;
                           font-weight: 400;
                           font-size: 26px;
                           line-height: 55px;
                           color: #BFD2F8;
                           border-color: #BFD2F8">
          <a><button type="submit" class="btn" onclick="modifySchedule()"
                                                style="background-color: #BFD2F8;
                                                            color: #1F2B6C;
                                                            border-radius: 50px;
                                                            font-weight: 500;
                                                            font-family: Work_Sans;">Modify Schedule</button></a>
        </div>
      </form>
    </div>

  </div>

  <!-- FOOTER -->
  <div class="container-fluid pt-5 pb-3 px-5" style="background-color: #1F2B6C;">
    <div class="container-fluid pt-2 pb-2 px-5 text-center header_title" style="color: #BFD2F8;">HOSPITALPLANNER</div>
    <div class="container-fluid pt-2 pb-5 px-5 text-center" style="font-weight: 400; font-size: 18px; line-height: 140%; color: #FCFEFE; font-family: Work_Sans;">
      Proiecteare Avansata - Facultatea de Informatica Iasi - 2023<br>Â© Chichirau Claudiu-Constantin & Onofrei Maria
    </div>
  </div>

</body>

<script>
  // function to display doctor schedule
  window.addEventListener("DOMContentLoaded", function() {
    var startTimeInputs = document.querySelectorAll("[id^='startTime_']");
    var endTimeInputs = document.querySelectorAll("[id^='endTime_']");

    startTimeInputs.forEach(function(input) {
      var startTimeValue = input.getAttribute("data-start-time");
      input.value = startTimeValue;
    });

    endTimeInputs.forEach(function(input) {
      var endTimeValue = input.getAttribute("data-end-time");
      input.value = endTimeValue;
    });
  });

  // function that modify the doctor schedule
  function modifySchedule() {
    var modifiedHours = [];
    var modifiedDays = [];

    var hourInputs = document.querySelectorAll('.time_box');
    var dayInputs = document.querySelectorAll('#days_input');

    hourInputs.forEach(function(input) {
      modifiedHours.push(input.value);
    });

    dayInputs.forEach(function(input) {
      modifiedDays.push(input.innerText);
    });

    var data = {
      hours: modifiedHours,
      days: modifiedDays
    };

    fetch('/adminViewCabinetsSchedule/modifySchedule', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(data)
    })
    .catch(function(error) {
      console.log(error);
    });
  }
</script>
</html>